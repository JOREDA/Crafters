4. JWT + session token handling
Backend:
Install JWT package:

nginx
Copy
Edit
pip install djangorestframework-simplejwt
In settings.py:

python
Copy
Edit
REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': (
        'rest_framework_simplejwt.authentication.JWTAuthentication',
    ),
}
In urls.py:

python
Copy
Edit
from rest_framework_simplejwt.views import TokenObtainPairView, TokenRefreshView

urlpatterns += [
    path('api/token/', TokenObtainPairView.as_view(), name='token_obtain_pair'),
    path('api/token/refresh/', TokenRefreshView.as_view(), name='token_refresh'),
]
Frontend:
After login, store JWT in localStorage or sessionStorage.
For guest carts, generate a session_token on the frontend (e.g., uuidv4) and store it in a cookie. Send it with each cart API request.

‚ö† WHERE TO HANDLE:
Session token management (frontend):

When user lands on site ‚Üí check if cookie session_token exists.

If not, generate one (uuid) and store it.

Attach it to Cart API requests.

‚Üí Done in React (e.g., localStorage, Cookies.set()).

Expiry of old carts/wishlists (backend):

Add a Django management command or use celery beat + cron.

Example cleanup logic:

python
Copy
Edit
Cart.objects.filter(updated_at__lt=timezone.now() - timedelta(days=30)).delete()
Wishlist.objects.filter(created_at__lt=timezone.now() - timedelta(days=180)).delete()
Permission locking on views:

Already handled in views with IsAuthenticated.

For guest cart endpoints, you‚Äôll need a custom permission to allow AllowAny + check session_token in the view.

üî• Honest advice:
If you skip the cleanup jobs or guest token checks, your database will rot into a garbage pile of orphan carts + wishlists. You must budget time to set this up.

üëâ Want me to write the management command for cart/wishlist cleanup + a sample React session_token handler?
Just say ‚ÄúYes, cleanup + React snippet.‚Äù Want it?